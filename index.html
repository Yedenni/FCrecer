function doPost(e) {
  const sheetName = 'DatosFormulario'; // Nombre de tu hoja de cálculo
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  let sheet = ss.getSheetByName(sheetName);

  // Si la hoja no existe, la crea
  if (!sheet) {
    sheet = ss.insertSheet(sheetName);
    // Añade los encabezados si la hoja es nueva
    const headers = [
      "Fecha y Hora",
      "Nombre de Empresa",
      "Dirección",
      "Teléfono",
      "Encargado",
      "Correo Electrónico",
      "Observación",
      "Enlace de Google Maps" // ¡Encabezado actualizado!
    ];
    sheet.appendRow(headers);
  }

  // Obtiene los datos del formulario
  const data = e.parameter; // Si envías FormData (como está configurado por defecto)

  // Prepara la fila para añadir a la hoja
  const rowData = [
    data['Fecha y Hora'],
    data['Nombre de Empresa'],
    data['Dirección'],
    data['Teléfono'],
    data['Encargado'],
    data['Correo Electrónico'],
    data['Observación'],
    data['Enlace de Google Maps'] // ¡Campo actualizado!
  ];

  // Añade la fila a la hoja de cálculo
  sheet.appendRow(rowData);

  // Devuelve una respuesta JSON al formulario web
  return ContentService.createTextOutput(JSON.stringify({ status: 'success', message: 'Datos guardados con éxito' }))
    .setMimeType(ContentService.MimeType.JSON);
}